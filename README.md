# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
## Архитектура проекта и взаимодействия
В основе архитектуры проекта лежит событийно-ориентированный подход, обеспечивающий динамичное взаимодействие между различными компонентами системы :   
- `Модели` : Отвечают за управление и хранение данных. Они инициируют события при изменении состояния данных, например, при добавлении товара в корзину или изменении деталей заказа.
- `Слушатели событий` : Расположены в основном коде приложения и реагируют на инициированные моделями события. Они выполняют необходимые вычисления или обработку данных и передают их компонентам отображения для последующего визуального представления.
- `Компоненты отображения` : Отвечают за представление данных пользователю. Они обновляются в ответ на изменения в моделях, отражая актуальное состояние сайта.
- `Обратная связь и изменение моделей` : Взаимодействие пользователя с компонентами отображения (например, формы ввода или кнопками) генерирует события, которые возвращаются в модели для обновления данных.
***
## Модели






## Слушатели событий

### 1.`Api`
Класс `Api` является ключевым элементом для взаимодействия с внешними API и сервером в рамках проекта. Он отвечает за отправку HTTP-запросов и обработку ответов от сервера. Это включает в себя стандартные операции,такие как получение данных (`GET`) и отправка данных (`POST`).   

#### Структура и назначение
- `baseUrl` : Основной URL для запросов к API.
- `options` : Настройки для запросов, включая заголовки.

##### Конструктор
`constructor(baseUrl: string, options: RequestInit = {})` - Инициализирует базовый URL и заголовки для запросов.

##### Методы
- `handleResponse(response: Response): Promise<object>` : Защищенный метод, обрабатывает ответы сервера. Возвращает данные в формате JSON или генерит ошибку при неудачном ответе.
- `get(uri: string): Promise<object>` : Выполняет GET-запрос к указанному URI. Использует `handleResponse` для обработки ответа.
- `post(uri: string, data: object, method: ApiPostMethods = 'POST'): Promise<object>` : Выполняет POST-запрос с телом запроса и указанным методом. Также использует `handleResponse`. 

#### Типы данных
- `ApiPostMethods` : Тип, описывающий допустимые методы HTTP-запросов для POST-операций.
- `ApiListResponse<Type>` : Тип, представляющий стандартный ответ API со списком элементов и общим количеством.

#### Взаимодействие с другими частями приложения
`Api` не взаимодействует напрямую с пользовательским интерфейсом, но предоставляет данные для моделей и компонентов отображения. Ответы от сервера, полученные через `Api`, могут быть использованы для обновления состояния проекта и отображения информации пользователю.

#### Использование в архитектуре
`Api` поддерживает архитектурный паттерн, основанный на централизованном управлении данными и взаимодействии с внешними ресурсами. Он не относится напрямую к паттернам MVC, MVP или MVVM, но обеспечивает важную интеграцию между клиентской частью приложения и сервером.


## Компоненты отображения

### 1. `Component`
Класс `Component` является абстрактным базовым классом для всех компонентов пользовательского интерфейса в проекте. Он представляет общий функционал для работы с DOM-элементами и управления их поведением и внешним видом.
#### Структура и назначение

##### Конструктор
`constructor(container: HTMLElement)` - Принимает DOM элемент, который является корневым элементом компонента.

##### Методы
- `toggleClass` : Добавляет и удаляет CSS-класс у элемента.
- `setText` : Устанавливает текстовое содержимое элемента.
- `setDisabled` : Меняет статус блокировки (disabled) элемента.
- `setHidden`/`setVisible` : Управляет видимостью элемента.
- `setImage` : Устанавливает изображение и альтернативный текст для элемента изображения.
- `render(data?: Partial<T>): HTMLElement` : Метод для рендеринга компонента. Принимает опциональные данные и обновляет состояние компонента перед его отображением.

#### Типы данных
`T` : Обобщенный тип (Generic), представляющий структуру данных, с которыми работает компонент.

#### Взаимодействие с другими частями приложения
Компоненты, наследующиеся от `Component`, используются для создания конкретных элементов пользовательского интерфейса. Они могут взаимодейстовать с моделями для отображения данных и обрабатывать пользовательский ввод, генерируя события, которые влияют на данные проекта.

#### Использование в архитектуре
Класс `Component` лежит в основе системы управления пользовательским интерфейсом, обеспечивая единый подход к созданию и управлению визуальными компонентами проекта. Он ключевой для реализации интерактивных и динамичных интерфейсов.





## Обратная связь и изменение моделей.



































































## Базовый код
Включает в себя низкоуровневые утилиты, сервисы и конфигурации, которые яаляются фундаментом приложения.

### 1. `Брокер событий (EventEmitter)`
Класс который обеспечивает управление событиями в приложении. Он позволяет подписываться на события, генерировать события и управлять обработчиками.  
`constructor()` - создает новый экземпляр брокера событий.  
#### Методы:  
- `on / off` : Подписывает обработчик на событие / Удаляет обработчик события с указанным именем.
- `emit` : Генерирует событие с указанным именем и данными для всех подписанных обработчиков событий.
- `onAll / offAll` : Подписывает / Удаляет обработчик на все события.
- `trigger` : Создает 'триггер' для события с указанным именем и контекстом, который можно вызвать для генерации события.

### 2. `Api`
Класс представляет собой инструмент для взаимодействия с удаленным веб-сервером посредством HTTP запросов.  
`constructor(baseUrl: string, options: RequestInit = {})` - создает новый экземпляр класса с указанным URL-адрессом и настраивает объект опций.  
#### Методы :  
- `handleResponse` : Метод отвечающий за обработку ответа от сервера после отправки HTTP запроса.
- `get` : Метод для выполнения HTTP GET запроса к Api.
- `post` : Метод для выполнения HTTP POST запроса к Api.

### 3. `Component<T>`
Абстрактный класс для создания компонентов пользовательского интерфейса. Представляет общие методы и утилиты для работы с DOM элементами и является основой для всех компонентов.  
`constructor(container: HTMLElement)` - Принимает HTML элемент, который будет использоваться как контейнер для компонента.  
#### Методы :   
- `render` : Отрисовывает компонент, применяя переданные данные. Возвращает корневой элемент коммпонента.
- `toggleClass` : Переключает класс у заданного элемента.
- `setText` : Устанавливает текстовое содержимое для элемента.
- `setDisabled` : Устанавливает или снимает блокировку элемента.
- `setHidden / setVisible` : Скрывает / Показывает элемент.
- `setImage` : Устанавливает изображение и альтернативный текст для элемента img.

### 4. `Model<T>`
Служит основой для всех моделей данных. Он предоставляет методы для управления состоянием взаимодействия с другими компонентами через систему событий.  
`constructor(data: Partial<T>, events: IEvents)` - Принимает объект данных и объект событий. Инициализирует модель, присваивая ей предоставленные данные.  
#### Методы :  
- `emitChanges` : Оповещает о изменениях в модели, отправляя событие через систему событий.

## Компоненты модели данных.
### 1. `Product`
Класс представляет собой модель данных для товара в интернет-магазине. Он включает в себя все необходимые свойства, которые описывают товар, и методы для управления этими данными.   
Наследуется от `Model<IProduct>`   
`constructor()` наследуется от `Model`   
#### Методы :
Наследуются от `Model`.   

### 2. `AppState`
Класс отвечает за управление и хранение центролизованного состояния приложения. Инкапсулирует в себе данные о каталоге товаров, корзине покупок, текущем заказе, а также информацию для предпросмотра товаров и обработки форм.   
Наследуется от `Model<IAppState>`
`constructor` наследуется от `Model`   
#### Методы :
- `addToBasket / removeFromBasket` : Добавляет / Удаляет товар изз корзины.
- `clearBasket` : Очищает корзину.
- `calculateTotal` : Вычисляет общую стоимость товаров в корзине.
- `setCatalog` : Обновляет каталог товаров.
- `setPreview` : Устанавливает товар для предпросмотра.
- `setOrderField` : Устанавливает значение поля формы заказа.
- `validateOrder` : Проверяет валидность информации заказа.
- `setContactField` : Устанавливает значение поля контактной информации.
- `validateContact` : Проверяет валидность контактной информации.   

## Компоненты представления.
### 1. `Page`   
Компонент является базовым компонентом для страницы. Он отвечает за управление ключевыми элементами страницы, такими как счетчик корзины, каталог товаров и блокировка страницы.   
Наследуется от `Component<IPage>`  
`constructor(container: HTMLElement, events: IEvents)` - `container`: Контейнер, в котором будет размещаться компонент страницы, `events` - Объект для управления событиями.   
#### Методы :   
- `set counter` : Обновляет текстовое содержимое счетчика корзины в соотвествии с переданным значением.
- `set catalog` : Заменяет дочерние элементы каталога товаров на переданный массив элементов.
- `set locked` : Добавляет и удаляет класс у обертки страницы в зависимости от значения.

### 2. `Modal`
Компонент для создания и управления модальными окнами на сайте.   
Наследуется от `Component<IModalData>`   
`constructor(container: HTMLElement, events: IEvents)` - Инициализирует элементы модального окна и связывает события.
#### Методы :
- `set content` : Устанавливает содержимое модального окна.
- `open` : Открывает модальное окно и инициализирует событие открытия модального окна.
- `close` : Закрывает модальное окно, очищает его содержимое и инициирует событие закрытия модального окна.
- `render` : Рендерит модальное окно с данными и открывает его.

### 3. `Form`
Компонент для управления формами. Он обрабатывает пользовательский ввод, отображает ошибки валидации и управляет отправкой формы.   
Наследуется от `Component<IFormState>`   
`constructor(container: HTMLFormElement, events: IEvents)` - Инициализация элементов формы и привязка событий.   
#### Методы :
- `onInputChange` : Обработка изменений в полях ввода.
- `set valid` : Установка доступности кнопки отправки формы в зависимости от ее валидности.
- `set errors` : Отображение ошибок валидации в форме.
- `render` : Рендеринг формы с учетом текущего состояния.

### 4. `Card`
Компонент для отображения карточки товара. Он обеспечивает отображение важной информации о товаре и обработку пользовательских взаимодействий, таких как клик по кнопке.   
Наследуется от `Component<ICard>`   
`constructor(container: HTMLElement, actions?: IActions)` - Инициализация элементов карточки и привязка событий.
#### Методы :
- `unablePriceButton` : Управляет доступностью кнопки в зависимости от цены.
- `set / get id, index, title, description, category, price, image, buttonTitle` : Сеттеры и геттеры для свойств карточки.

### 5. `Basket`
Компонент для отображения и управления корзиной покупок. Он определяет функциональность для отображения списка товаров, общей стоимости и управления кнопкой оформления заказа.   
Наследуется от `Component<IBasketView>`   
`constructor(container: HTMLElement, events: EventEmitter)` - Инициализация элементов корзины и привязка событий.
#### Методы :
- `toggleStateButton` : Управляет доступностью кнопки оформления заказа.
- `set items` : Устанавливает товары в корзине.
- `set total` : Устанавливает общую стоимость товаров в корзине.

### 6. `OrderForm`
Компонент предназначен для управления формой доставки, включая обработку ввода личных данных пользователем и выбора способа оплаты.   
Наследуется от `Form<IOrderForm>`   
`constructor(container: HTMLFormElement, events: IEvents, actions?: IActions)` - Инициализирует элементы формы и привязывает союытия.
#### Методы :
- `toggleStateButtons` : Переключает активное состояние кнопок выбора способа оплаты.
- `set address` : Устанавливает адресс доставки.

### 7. `ContactForm`
Компонент предназначен для управления формой доставки данных, включая обработку ввода телефона и электронной почты пользователя.   
наследуется от `Form<IContactForm>`   
`constructor(container: HTMLFormElement, events: IEvents)` - Инициализирует форму контактных данных.   
#### Методы :
- `set phone` : Устанавливает номер телефона в форме.
- `set email` : Устанавливает адресс электронной почты в форме.

### 8. `Success`
Компонент для отображения сообщений об успешных операциях на сайте. Он может использоваться для информирования пользователя о успешном завершении различных процессов, таких как оформления заказа или успешная оплата.   
Наследуется от `Component<ISuccess>`   
`constructor(container: HTMLElement, actions: ISuccessActions)` - Инициализирует элементы уведомления и привязывает события.   
#### Методы :
- `set total` : Устанавливает текстовое содержимое, связанное с успешной операцией.
